
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>GlobalGraphics &#8212; pyimgalgos-doc 1 documentation</title>
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">pyimgalgos-doc 1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for GlobalGraphics</h1><div class="highlight"><pre>
<span></span><span class="ch">#!@PYTHON@</span>
<span class="c1">####!/usr/bin/env python</span>
<span class="c1">#------------------------------</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">:py:class:`GlobalGraphics` - collection of global graphical methods</span>
<span class="sd">===================================================================</span>

<span class="sd">Usage::</span>

<span class="sd">    import pyimgalgos.GlobalGraphics as gg</span>

<span class="sd">    # Methods</span>

<span class="sd">    fig, axim, axcb = gg.fig_axes(figsize=(13,12), title=&#39;Image&#39;, dpi=80, win_axim=(0.05, 0.03, 0.87, 0.93), win_axcb=(0.923, 0.03, 0.02, 0.93))</span>
<span class="sd">    fig, axim, axcb, imsh = gg.fig_axim_axcb_imsh(figsize=(13,12), title=&#39;Image&#39;, dpi=80, win_axim=(0.05, 0.03, 0.87, 0.93),</span>
<span class="sd">                            win_axcb=(0.923, 0.03, 0.02, 0.93), arr2d=np.zeros((10,10)), origin=&#39;upper&#39;)</span>
<span class="sd">    gg.plot_imgcb(fig, axim, axcb, imsh, arr2d, amin=None, amax=None, origin=&#39;upper&#39;, title=None, cmap=&#39;inferno&#39;)</span>
<span class="sd">    gg.plot_img(img, mode=None, amin=None, amax=None, cmap=&#39;inferno&#39;)</span>
<span class="sd">    gg.plot_peaks_on_img(peaks, axim, iX, iY, color=&#39;w&#39;, pbits=0, lw=2)</span>
<span class="sd">    size = gg.size_of_shape(shape=(2,3,8))</span>
<span class="sd">    arr = gg.getArrangedImage(shape=(40,60))</span>
<span class="sd">    arr = gg.getRandomImage(mu=200, sigma=25, shape=(40,60))</span>
<span class="sd">    hi = gg.getImageAs2DHist(iX,iY,W=None)</span>
<span class="sd">    img = gg.getImageFromIndexArrays(iX,iY,W=None)</span>
<span class="sd">    fig, axhi, hi = gg.plotHistogram(arr, amp_range=None, figsize=(6,6), bins=None, title=&#39;&#39;, window=(0.15, 0.10, 0.78, 0.82))</span>
<span class="sd">    fig, axhi, hi = gg.hist1d(arr, bins=None, amp_range=None, weights=None, color=None, show_stat=True,</span>
<span class="sd">                              log=False, figsize=(6,5), axwin=(0.15, 0.12, 0.78, 0.80), title=None, </span>
<span class="sd">                              xlabel=None, ylabel=None, titwin=None)</span>
<span class="sd">    axim = gg.plotImageLarge(arr, img_range=None, amp_range=None, figsize=(12,10), title=&#39;Image&#39;, origin=&#39;upper&#39;, </span>
<span class="sd">                             window=(0.05, 0.03, 0.94, 0.94), cmap=&#39;inferno&#39;)</span>
<span class="sd">    gg.plotImageAndSpectrum(arr, amp_range=None, cmap=&#39;inferno&#39;) </span>
<span class="sd">    fig, ax = gg.plotGraph(x,y, figsize=(5,10), window=(0.15, 0.10, 0.78, 0.86), pfmt=&#39;b-&#39;, lw=1)</span>
<span class="sd">    gg.drawCircle(axes, xy0, radius, linewidth=1, color=&#39;w&#39;, fill=False)</span>
<span class="sd">    gg.drawCircle(axes, xy0, radius, linewidth=1, color=&#39;w&#39;, fill=False)</span>
<span class="sd">    gg.drawCenter(axes, xy0, s=10, linewidth=1, color=&#39;w&#39;)</span>
<span class="sd">    gg.drawLine(axes, xarr, yarr, s=10, linewidth=1, color=&#39;w&#39;)</span>
<span class="sd">    gg.drawRectangle(axes, xy, width, height, linewidth=1, color=&#39;w&#39;)</span>
<span class="sd">    gg.save(fname=&#39;img.png&#39;, do_save=True, pbits=0377)</span>
<span class="sd">    gg.save_fig(fig, fname=&#39;img.png&#39;, do_save=True, pbits=0377)</span>
<span class="sd">    gg.move(x0=200,y0=100)</span>
<span class="sd">    gg.move_fig(fig, x0=200, y0=100)</span>
<span class="sd">    gg.show(mode=None)</span>

<span class="sd">See:</span>
<span class="sd">  - :py:class:`Graphics`</span>
<span class="sd">  - :py:class:`GlobalGraphics`</span>
<span class="sd">  - :py:class:`NDArrGenerators`</span>
<span class="sd">  - `matplotlib &lt;https://matplotlib.org/contents.html&gt;`_.</span>

<span class="sd">This software was developed for the SIT project.  If you use all or </span>
<span class="sd">part of it, please give an appropriate acknowledgment.</span>

<span class="sd">Created in 2015 by Mikhail Dubrovin</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#--------------------------------</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="c1">#if matplotlib.get_backend() != &#39;Qt4Agg&#39; : matplotlib.use(&#39;Qt4Agg&#39;)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>  <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.lines</span>   <span class="k">as</span> <span class="nn">lines</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>

<span class="kn">from</span> <span class="nn">CalibManager.PlotImgSpeWidget</span> <span class="k">import</span> <span class="n">add_stat_text</span>

<span class="c1">#------------------------------</span>

<span class="k">class</span> <span class="nc">Storage</span> <span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">pass</span>

<span class="c1">#------------------------------</span>
<span class="n">store</span> <span class="o">=</span> <span class="n">Storage</span><span class="p">()</span> <span class="c1"># singleton</span>
<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="fig_axes"><a class="viewcode-back" href="../index.html#GlobalGraphics.fig_axes">[docs]</a><span class="k">def</span> <span class="nf">fig_axes</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Image&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> \
             <span class="n">win_axim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span>  <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">),</span> \
             <span class="n">win_axcb</span><span class="o">=</span><span class="p">(</span><span class="mf">0.923</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">))</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Creates and returns figure, and axes for image and color bar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axim</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">win_axim</span><span class="p">)</span>
    <span class="n">axcb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">win_axcb</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">store</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">store</span><span class="o">.</span><span class="n">axim</span><span class="p">,</span> <span class="n">store</span><span class="o">.</span><span class="n">axcb</span> <span class="o">=</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axim</span><span class="p">,</span> <span class="n">axcb</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axim</span><span class="p">,</span> <span class="n">axcb</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="fig_axim_axcb_imsh"><a class="viewcode-back" href="../index.html#GlobalGraphics.fig_axim_axcb_imsh">[docs]</a><span class="k">def</span> <span class="nf">fig_axim_axcb_imsh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Image&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>\
                       <span class="n">win_axim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span>  <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">),</span>\
                       <span class="n">win_axcb</span><span class="o">=</span><span class="p">(</span><span class="mf">0.923</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">),</span>\
                       <span class="n">arr2d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)),</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Creates and returns figure, axes for image and color bar, imshow object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axim</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">win_axim</span><span class="p">)</span>
    <span class="n">axcb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">win_axcb</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">imsh</span> <span class="o">=</span> <span class="n">axim</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr2d</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">)</span> 
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axim</span><span class="p">,</span> <span class="n">axcb</span><span class="p">,</span> <span class="n">imsh</span></div>

<span class="c1">#------------------------------</span>

<span class="k">def</span> <span class="nf">plot_imgcb</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axim</span><span class="p">,</span> <span class="n">axcb</span><span class="p">,</span> <span class="n">imsh</span><span class="p">,</span> <span class="n">arr2d</span><span class="p">,</span> <span class="n">amin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">if</span> <span class="n">arr2d</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span>
    <span class="k">if</span> <span class="n">imsh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">imsh</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">arr2d</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span> <span class="n">imsh</span> <span class="o">=</span> <span class="n">axim</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr2d</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> 
    <span class="n">ave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr2d</span><span class="p">)</span> <span class="k">if</span> <span class="n">amin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">amax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">arr2d</span><span class="p">)</span>  <span class="k">if</span> <span class="n">amin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">amax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="c1">#print &#39;img ave = %s, rms = %s&#39; % (str(ave), str(rms))</span>
    <span class="n">cmin</span> <span class="o">=</span> <span class="n">amin</span> <span class="k">if</span> <span class="n">amin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ave</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">rms</span> <span class="k">if</span> <span class="n">ave</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">cmax</span> <span class="o">=</span> <span class="n">amax</span> <span class="k">if</span> <span class="n">amax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ave</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">rms</span> <span class="k">if</span> <span class="n">ave</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">cmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">imsh</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span><span class="p">)</span>
    <span class="n">colb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">imsh</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">axcb</span><span class="p">)</span> <span class="c1"># , orientation=&#39;horizontal&#39;)</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>    

<span class="c1">#------------------------------</span>

<span class="k">def</span> <span class="nf">plot_img</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span> <span class="p">:</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axim</span><span class="p">,</span> <span class="n">axcb</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">store</span><span class="o">.</span><span class="n">axim</span><span class="p">,</span> <span class="n">store</span><span class="o">.</span><span class="n">axcb</span>

    <span class="n">axim</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">imsh</span> <span class="o">=</span> <span class="n">axim</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> <span class="c1"># extent=img_range)</span>
    <span class="n">colb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">imsh</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">axcb</span><span class="p">)</span> <span class="c1"># , orientation=&#39;horizontal&#39;)</span>

    <span class="n">ave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">if</span> <span class="n">amin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">amax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>  <span class="k">if</span> <span class="n">amin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">amax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="c1">#print &#39;img ave = %f, rms = %f&#39; % (ave, rms)</span>
    <span class="n">store</span><span class="o">.</span><span class="n">amin</span> <span class="o">=</span> <span class="n">amin</span> <span class="k">if</span> <span class="n">amin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ave</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">rms</span>
    <span class="n">store</span><span class="o">.</span><span class="n">amax</span> <span class="o">=</span> <span class="n">amax</span> <span class="k">if</span> <span class="n">amax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ave</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">rms</span>

    <span class="n">imsh</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">amin</span><span class="p">,</span> <span class="n">store</span><span class="o">.</span><span class="n">amax</span><span class="p">)</span>

    <span class="c1">#print_help(1)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span> <span class="c1"># hold contraol at show() (connect to keyboard for controllable re-drawing)</span>
    <span class="k">else</span>            <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>  <span class="c1"># do not hold control</span>

    <span class="c1">#fig.canvas.draw()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">##-----------------------------</span>

<div class="viewcode-block" id="plot_peaks_on_img"><a class="viewcode-back" href="../index.html#GlobalGraphics.plot_peaks_on_img">[docs]</a><span class="k">def</span> <span class="nf">plot_peaks_on_img</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">axim</span><span class="p">,</span> <span class="n">iX</span><span class="p">,</span> <span class="n">iY</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">pbits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="p">:</span>  
    <span class="sd">&quot;&quot;&quot; Draws peaks on the top of image axes (axim)</span>
<span class="sd">        Plots peaks from array as circles in coordinates of image.</span>

<span class="sd">        - peaks - 2-d list/tuple of peaks; first 6 values in each peak record should be (s, r, c, amax, atot, npix)  </span>
<span class="sd">        - axim - image axes</span>
<span class="sd">        - iX - array of x-coordinate indexes for all pixels addressed as [s, r, c] - segment, row, column</span>
<span class="sd">        - iX - array of y-coordinate indexes for all pixels addressed as [s, r, c] - segment, row, column</span>
<span class="sd">        - color - peak-ring color</span>
<span class="sd">        - pbits - verbosity; print 0 - nothing, +1 - peak parameters, +2 - x, y peak coordinate indexes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">peaks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span>

    <span class="c1">#anorm = np.average(peaks,axis=0)[4] if len(peaks)&gt;1 else peaks[0][4] if peaks.size&gt;0 else 100    </span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">peaks</span> <span class="p">:</span>
        <span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">amax</span><span class="p">,</span> <span class="n">atot</span><span class="p">,</span> <span class="n">npix</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">pbits</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;s, r, c, amax, atot, npix=&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">amax</span><span class="p">,</span> <span class="n">atot</span><span class="p">,</span> <span class="n">npix</span>
        <span class="n">inds</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="k">if</span> <span class="n">iX</span><span class="o">.</span><span class="n">ndim</span><span class="o">&gt;</span><span class="mi">2</span> <span class="k">else</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
        <span class="n">x</span><span class="o">=</span><span class="n">iX</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="n">y</span><span class="o">=</span><span class="n">iY</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">pbits</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39; x,y=&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span>        
        <span class="n">xyc</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        <span class="c1">#r0  = 2+3*atot/anorm</span>
        <span class="n">r0</span>  <span class="o">=</span> <span class="mi">5</span>
        <span class="n">circ</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">xyc</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">r0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axim</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span></div>

<span class="c1">##-----------------------------</span>

<span class="k">def</span> <span class="nf">size_of_shape</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="p">:</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">shape</span> <span class="p">:</span> <span class="n">size</span> <span class="o">*=</span> <span class="n">d</span>
    <span class="k">return</span> <span class="n">size</span>

<span class="c1">#------------------------------</span>

<span class="k">def</span> <span class="nf">getArrangedImage</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span> <span class="p">:</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_of_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span>
    <span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span>
    <span class="k">return</span> <span class="n">arr</span>

<span class="c1">#--------------------------------</span>

<span class="k">def</span> <span class="nf">getRandomImage</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span> <span class="p">:</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">arr</span>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="getImageAs2DHist"><a class="viewcode-back" href="../index.html#GlobalGraphics.getImageAs2DHist">[docs]</a><span class="k">def</span> <span class="nf">getImageAs2DHist</span><span class="p">(</span><span class="n">iX</span><span class="p">,</span><span class="n">iY</span><span class="p">,</span><span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Makes image from iX, iY coordinate index arrays and associated weights, using np.histogram2d(...).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">iX</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span> 
    <span class="n">ysize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">iY</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">weights</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span>         <span class="p">:</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">H</span><span class="p">,</span><span class="n">Xedges</span><span class="p">,</span><span class="n">Yedges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">iX</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">iY</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="p">(</span><span class="n">xsize</span><span class="p">,</span><span class="n">ysize</span><span class="p">),</span> <span class="nb">range</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">xsize</span><span class="o">-</span><span class="mf">0.5</span><span class="p">),(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ysize</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)),</span> <span class="n">normed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span> 
    <span class="k">return</span> <span class="n">H</span></div>

<span class="c1">#------------------------------</span>

<div class="viewcode-block" id="getImageFromIndexArrays"><a class="viewcode-back" href="../index.html#GlobalGraphics.getImageFromIndexArrays">[docs]</a><span class="k">def</span> <span class="nf">getImageFromIndexArrays</span><span class="p">(</span><span class="n">iX</span><span class="p">,</span><span class="n">iY</span><span class="p">,</span><span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Makes image from iX, iY coordinate index arrays and associated weights, using indexed array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xsize</span> <span class="o">=</span> <span class="n">iX</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span> 
    <span class="n">ysize</span> <span class="o">=</span> <span class="n">iY</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">iX</span><span class="p">)</span>
    <span class="k">else</span>         <span class="p">:</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">W</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xsize</span><span class="p">,</span><span class="n">ysize</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">img</span><span class="p">[</span><span class="n">iX</span><span class="p">,</span><span class="n">iY</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span> <span class="c1"># Fill image array with data </span>
    <span class="k">return</span> <span class="n">img</span></div>

<span class="c1">#--------------------------------</span>

<div class="viewcode-block" id="plotHistogram"><a class="viewcode-back" href="../index.html#GlobalGraphics.plotHistogram">[docs]</a><span class="k">def</span> <span class="nf">plotHistogram</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">))</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Makes historgam from input array of values (arr), which are sorted in number of bins (bins) in the range (amp_range=(amin,amax))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axhi</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">hbins</span> <span class="o">=</span> <span class="n">bins</span> <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">100</span>
    <span class="n">hi</span> <span class="o">=</span> <span class="n">axhi</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">hbins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">amp_range</span><span class="p">)</span> <span class="c1">#, log=logYIsOn)</span>
    <span class="c1">#fig.canvas.set_window_title(title)</span>
    <span class="n">axhi</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axhi</span><span class="p">,</span> <span class="n">hi</span></div>

<span class="c1">#--------------------------------</span>

<div class="viewcode-block" id="hist1d"><a class="viewcode-back" href="../index.html#GlobalGraphics.hist1d">[docs]</a><span class="k">def</span> <span class="nf">hist1d</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_stat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>\
           <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">axwin</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">),</span>\
           <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">titwin</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Makes historgam from input array of values (arr), which are sorted in number of bins (bins) in the range (amp_range=(amin,amax))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#print &#39;hist1d: title=%s, size=%d&#39; % (title, arr.size)</span>
    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">size</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span>   <span class="n">titwin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">titwin</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">title</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">axhi</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">axwin</span><span class="p">)</span>
    <span class="n">hbins</span> <span class="o">=</span> <span class="n">bins</span> <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">100</span>
    <span class="n">hi</span> <span class="o">=</span> <span class="n">axhi</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">hbins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">amp_range</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span> <span class="c1">#, log=logYIsOn)</span>
    <span class="k">if</span> <span class="n">amp_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">axhi</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">amp_range</span><span class="p">)</span> <span class="c1"># axhi.set_autoscale_on(False) # suppress autoscailing</span>
    <span class="k">if</span> <span class="n">title</span>  <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">axhi</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">axhi</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">axhi</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_stat</span> <span class="p">:</span>
        <span class="n">weights</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">hi</span>
        <span class="n">add_stat_text</span><span class="p">(</span><span class="n">axhi</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axhi</span><span class="p">,</span> <span class="n">hi</span></div>

<span class="c1">#--------------------------------</span>

<span class="k">def</span> <span class="nf">plotSpectrum</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="p">:</span> <span class="c1"># range=(0,500)</span>
    <span class="n">plotHistogram</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">amp_range</span><span class="p">,</span> <span class="n">figsize</span><span class="p">)</span>

<span class="c1">#--------------------------------</span>

<span class="k">def</span> <span class="nf">plotImage</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">img_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Image&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axim</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">imsh</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">img_range</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> <span class="c1">#,extent=self.XYRange, origin=&#39;lower&#39;</span>
    <span class="n">colb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">imsh</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">amp_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">imsh</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">amp_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">amp_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1">#axim.set_title(title, color=&#39;b&#39;, fontsize=20)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

<span class="c1">#--------------------------------</span>

<span class="k">def</span> <span class="nf">plotImageLarge</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">img_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Image&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span>  <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axim</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">imsh</span> <span class="o">=</span> <span class="n">axim</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">img_range</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">colb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">imsh</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span> <span class="c1"># orientation=1</span>
    <span class="k">if</span> <span class="n">amp_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">imsh</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">amp_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">amp_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1">#else : </span>
    <span class="c1">#    ave, rms = arr.mean(), arr.std()</span>
    <span class="c1">#    imsh.set_clim(ave-1*rms, ave+5*rms)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axim</span>

<span class="c1">#--------------------------------</span>

<span class="k">def</span> <span class="nf">plotImageAndSpectrum</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span> <span class="p">:</span> <span class="c1">#range=(0,500)</span>
    <span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s1">&#39;Image And Spectrum &#39;</span> <span class="o">+</span> <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u03C6</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">ax1</span>   <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">axim1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span> <span class="c1"># , origin=&#39;lower&#39; </span>
    <span class="n">colb1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">axim1</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">1.00</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">amp_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">axim1</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">amp_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">amp_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Image&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="n">ax2</span>   <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">amp_range</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Spectrum&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bins&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Stat&#39;</span><span class="p">)</span> <span class="c1">#u&#39;\u03C6&#39;</span>
    <span class="c1">#plt.ion()</span>

<span class="c1">#------------------------------</span>

<span class="k">def</span> <span class="nf">plotGraph</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">),</span> <span class="n">pfmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">pfmt</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

<span class="c1">#------------------------------</span>

<span class="k">def</span> <span class="nf">drawCircle</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xy0</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">circ</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">xy0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">drawCenter</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xy0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span> <span class="o">=</span> <span class="n">xy0</span>
    <span class="n">d</span> <span class="o">=</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">s</span>
    <span class="n">arrx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xc</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="n">xc</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">xc</span><span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span>   <span class="n">xc</span><span class="p">)</span>
    <span class="n">arry</span> <span class="o">=</span> <span class="p">(</span><span class="n">yc</span><span class="p">,</span>   <span class="n">yc</span><span class="p">,</span>   <span class="n">yc</span><span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="n">yc</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">yc</span><span class="o">+</span><span class="n">s</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">(</span><span class="n">arrx</span><span class="p">,</span> <span class="n">arry</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>   
    <span class="n">axes</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">drawLine</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xarr</span><span class="p">,</span> <span class="n">yarr</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">(</span><span class="n">xarr</span><span class="p">,</span> <span class="n">yarr</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>   
    <span class="n">axes</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">drawRectangle</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>

<span class="c1">#------------------------------</span>

<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;img.png&#39;</span><span class="p">,</span> <span class="n">do_save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbits</span><span class="o">=</span><span class="mi">0377</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">do_save</span> <span class="p">:</span> <span class="k">return</span>
    <span class="k">if</span> <span class="n">pbits</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;Save plot in file: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fname</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="c1">#--------------------------------</span>

<span class="k">def</span> <span class="nf">savefig</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;img.png&#39;</span><span class="p">,</span> <span class="n">do_print</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">save</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">do_save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbits</span><span class="o">=</span><span class="mi">0377</span> <span class="k">if</span> <span class="n">do_print</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">#------------------------------</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;img.png&#39;</span><span class="p">,</span> <span class="n">do_save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbits</span><span class="o">=</span><span class="mi">0377</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">do_save</span> <span class="p">:</span> <span class="k">return</span>
    <span class="k">if</span> <span class="n">pbits</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;Save plot in file: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fname</span> 
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="c1">#--------------------------------</span>

<span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">y0</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">get_current_fig_manager</span><span class="p">()</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>

<span class="c1">#--------------------------------</span>

<span class="k">def</span> <span class="nf">move_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>

<span class="c1">#--------------------------------</span>

<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span> <span class="c1"># hold contraol at show() (connect to keyboard for controllable re-drawing)</span>
    <span class="k">else</span>            <span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>  <span class="c1"># do not hold control</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span> <span class="c1"># hack to make it work... othervise show() does not work...</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#----------------------------------------------</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="p">:</span>

    <span class="n">arr</span> <span class="o">=</span> <span class="n">getRandomImage</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>   <span class="p">:</span>
        <span class="nb">print</span> <span class="s1">&#39;Use command &gt; python </span><span class="si">%s</span><span class="s1"> &lt;test-number [1-5]&gt;&#39;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span> <span class="p">(</span><span class="s1">&#39;Add &lt;test-number&gt; in command line...&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;1&#39;</span> <span class="p">:</span> <span class="n">plotImage</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="n">plotImageAndSpectrum</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;3&#39;</span> <span class="p">:</span> <span class="n">plotHistogram</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;4&#39;</span> <span class="p">:</span> <span class="n">plotImage</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;5&#39;</span> <span class="p">:</span> <span class="n">plotImageLarge</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">amp_range</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;6&#39;</span> <span class="p">:</span> <span class="n">plotImageLarge</span><span class="p">(</span><span class="n">getArrangedImage</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">)),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="nb">print</span> <span class="s1">&#39;Non-expected arguments: sys.argv=&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span> <span class="p">(</span><span class="s1">&#39;Check input parameters&#39;</span><span class="p">)</span>

    <span class="n">move</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">show</span><span class="p">()</span>

<span class="c1">#--------------------------------</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span> <span class="p">:</span>

    <span class="n">main</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span> <span class="p">(</span> <span class="s1">&#39;End of test.&#39;</span> <span class="p">)</span>

<span class="c1">#----------------------------------------------</span>
</pre></div>

          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          
          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Mikhail Dubrovin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>